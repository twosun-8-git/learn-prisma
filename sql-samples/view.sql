/**
  ビューテーブルの作成
  - ビューテーブルとは？
  - 実際には存在しない論理的なテーブル
  - 依存関係にある物理テーブル（productsテーブル）のデータを参照するため、依存元のテーブル、カラムが削除されるとエラーになる。
*/
CREATE VIEW product_summary AS
SELECT
  name AS 商品名,
  CONCAT('¥', FORMAT(price, 0)) AS 価格,
  stock AS 在庫数,
  CASE
    WHEN stock > 50 THEN '豊富'
    WHEN stock > 20 THEN '普通'
    ELSE '少なめ'
  END AS 在庫状況
FROM products;

/**
下記のようなビューが作成される

  | 商品名 | 価格 | 在庫数 | 在庫状況 |
  |--------|------|--------|----------|
  | エチオピア ブレンド | ¥1,800 | 100 | 豊富 |
  | コロンビア マイルド | ¥1,600 | 80 | 豊富 |
  | ブラジル サントス | ¥1,400 | 100 | 豊富 |
  | グアテマラ リッチ | ¥1,900 | 30 | 普通 |
  | ケニア フルーティー | ¥2,200 | 40 | 普通 |
  | ジャマイカ プレミアム | ¥3,850 | 5 | 少なめ |
  | ハワイ スムース | ¥3,080 | 25 | 普通 |
  | ペルー オーガニック | ¥700 | 200 | 豊富 |
  | インドネシア ロブスタ | ¥1,500 | 70 | 豊富 |

*/

-- ビューテーブルの削除（依存元の物理テーブルには影響しない）
DROP VIEW product_summary;
